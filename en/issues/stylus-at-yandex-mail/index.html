<!DOCTYPE html>
<html lang="en" class="Page Page_post Page_en without-sidebar">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>Stylus, Yandex.Mail and conditional IE styles</title>
    <link rel="alternate" type="application/atom+xml" title="Atom feed" href="http://feeds.feedburner.com/kizuruen">
    <link rel="stylesheet" href="/s/style.css">
    <link rel="preload" href="/s/extras2.css" as="style" onload="this.rel='stylesheet'">
  </head>
  <body class="Page-Body">
    <header class="Page-Header">
      <div class="LiquidLayout">
        <div class="LiquidLayout-Content">
          <h1 class="Page-Title"><a href="/en/" class="Page-Title-Link">Roman Komarov</a>
          </h1>
          <ul class="Page-Languages">
            <li data-short="en" class="Page-Language is-current">in English
            </li>
            <li class="Page-Language"><a data-short="ru" title="Для этой статьи пока нет перевода, почему — можете узнать перейдя по этой ссылке" href="/blog/just-en/" class="Page-Language-Link">по-русски?</a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <article role="main" class="Page-Content">
      <div class="LiquidLayout">
        <div class="Main LiquidLayout-Content">
          <header><h1 class="Heading" id="stylus-yandex-mail-and-conditional-ie-styles"><a class="Anchor" aria-hidden="true" href="#stylus-yandex-mail-and-conditional-ie-styles"></a><span class="ss01 hang-xs">S</span>ty­lus, Yan­dex.Mail and con­di­tional IE styles</h1>
          </header>
<p>Hi there. Here is a trans­la­tion of <a class="Link" href="http://habrahabr.ru/company/yandex/blog/169415/">the ar­ti­cle</a> I wrote in russ­ian for Yan­dex’ blog at Habra­habr. There I wrote on how we ended up with us­ing <a class="Link" href="http://learnboost.github.com/stylus">Sty­lus</a> <abbr>CSS</abbr> pre­proces­sor in our <a class="Link" href="http://mail.yandex.com/">Mail ser­vice</a> and why we did it.</p>
<p>Along with that I&#39;ll fea­ture my lit­tle li­brary/​method­ol­ogy on mess­ing with IE styles us­ing the magic of Sty­<span class="nobr">lus —</span><span class="thinsp"> </span><a class="Link" href="https://github.com/kizu/if-ie.styl"><span class="nobr">if-ie</span>.styl</a>.</p>
<p>That&#39;s only the first ar­ti­cle in the se­ries, I&#39;ll write more on how we use Sty­lus someday.</p>
<h2 class="Heading" id="how-we-ended-up-with-using-prepressors"><a class="Anchor" aria-hidden="true" href="#how-we-ended-up-with-using-prepressors"></a><span class="ss01 hang-m">H</span>ow we ended up with us­ing pre­pressors</h2>
<p>While our Mail ser­vice look like a sim­ple web app, it ac­tu­ally con­tains a lot of dif­fer­ent blocks, mod­i­fi­ca­tions of those blocks and dif­fer­ent con­text where those blocks could appear.</p>
<p>More­over, there are more than thirty themes avail­able for the app. There are themes with light and dark back­grounds, there are ones that dif­fer only with hues, and there are <span class="nobr">other —</span><span class="thinsp"> </span>like the one with the graph­i­cal in­ter­face made of plas­ticine (<a class="Link" href="https://www.youtube.com/watch?v=qrDU3ErUiHA&amp;hd=1">lit­er­ally</a>). Some themes have only one back­ground im­age, other could have a lot of dif­fer­ent vari­a­tions cho­sen ei­ther ran­domly or ac­cord­ing to the cur­rent weather or the time of the day.</p>
<p>All this re­sults in a lot of vari­a­tions of the vi­sual in­ter­face and makes us to find un­usual ways and tools that would fit our needs per­fectly.</p>
<p>When we started to de­velop the new (early 2010) ver­sion of the Yan­dex.Mail, we had the tool that we know: Tem­plate Toolkit 2, so we used it for gen­er­at­ing this <abbr>CSS</abbr> for themes. There were sim­ple vari­ables and con­di­tions, so it went ok. But with the num­ber and the com­plex­ity of themes grow­ing the tt2 be­come not that handy to use, so we started to look at the more spe­cialised <span class="nobr">tools —</span><span class="thinsp"> </span><abbr>CSS</abbr> Pre­processors.</p>
<h2 class="Heading" id="choosing-the-preprocessor"><a class="Anchor" aria-hidden="true" href="#choosing-the-preprocessor"></a><span class="ss02 hang-xs">C</span>hoos­ing the pre­processor</h2>
<p>We looked at the best three avail­able pre­proces­sors at the time: Sass, Less and Sty­lus. The se­lec­tion process was rather easy: we taken some of our com­plex blocks and tried to rewrite their <abbr>CSS</abbr> us­ing each of the pre­processors.</p>
<p><a class="Link" href="http://lesscss.org/"><strong>Less</strong></a> looked rather sim­ple and handy at first: it uses the fa­mil­iar <abbr>CSS</abbr> syn­tax and it can be used in the browser which is use­ful for de­bug­ging. How­ever, when we tried to make more com­plex things with it we found out that it&#39;s also sim­ple in other <span class="nobr">way —</span><span class="thinsp"> </span>what could you achieve with­out ar­rays, cy­cles and proper con­di­tions? Not that much.</p>
<p>Then we tried <a class="Link" href="http://sass-lang.com/"><strong>Sass</strong></a> and it was re­ally nice. Pow­er­ful, of­fer­ing two syn­taxes, com­mu­nity and a lot of ex­ist­ing code in­clud­ing li­braries like <a class="Link" href="http://compass-style.org/">Com­pass</a>. But we found out just one big draw­back there: Sass have very lim­ited par­ent ref­er­ence fea­ture (us­ing <code>&amp;</code> sym­bol in nested se­lec­tors to, well, ref­er­ence the par­ent). The main prob­lem is that you can&#39;t use it for pre­fix­ing with mul­ti­ple classes or el­e­ments and for con­cate­nat­ing the classes with any post­fixes. Here are a few ex­am­ples of what you <em>can&#39;t</em> do in Sass (and can in other pre­proces­sors):</p>
<ul>
<li><code>&amp;__bar</code></li>
<li><code>.baz&amp;</code></li>
<li><code>but­ton&amp;</code></li>
</ul>
<p>…</p>
<h2 class="Heading" id="if-ie-styl-library"><a class="Anchor" aria-hidden="true" href="#if-ie-styl-library"></a><a class="Link" href="https://github.com/kizu/if-ie.styl"><span class="nobr">if-ie</span>.styl</a> li­brary</h2>
<h3 class="Heading" id="the-base-for-the-methodology"><a class="Anchor" aria-hidden="true" href="#the-base-for-the-methodology"></a><span class="ss01 hang-m">T</span>he base for the method­ology</h3>
<h3 class="Heading" id="extra-features-of-if-ie-styl"><a class="Anchor" aria-hidden="true" href="#extra-features-of-if-ie-styl"></a><span class="ss01 hang-m">E</span>xtra fea­tures of <span class="nobr">if-ie</span>.styl</h3>
<h3 class="Heading" id="inline-block"><a class="Anchor" aria-hidden="true" href="#inline-block"></a><code>in­line-block</code></h3>
<h3 class="Heading" id="rgba-ie"><a class="Anchor" aria-hidden="true" href="#rgba-ie"></a><code>rgba-ie</code></h3>

          <p class="Metadata Published">Wrote as a draft, not published yet.
          </p>
          <aside class="Feedback">
            <p>If you've spotted a typo or a mistake, or wish to add something on, you could either <a href="https://github.com/kizu/kizu.github.com/issues/new?title=Feedback%20for%20%E2%80%9CStylus%2C%20Yandex.Mail%20and%20conditional%20IE%20styles%E2%80%9D" class="Link">write me about this</a> or <a href="https://github.com/kizu/kizu.github.com/blob/source/src/documents/posts/drafts/(issues)-stylus-at-yandex-mail/index.en.md" class="Link">edit this article on Github</a>.
            </p>
          </aside>
        </div>
      </div>
    </article>
    <footer class="Page-Footer">
      <div class="LiquidLayout">
        <div class="LiquidLayout-Content">
          <nav class="PrevNext">
          </nav>
          <p role="contentinfo" class="Page-Copy"><a href="/en/" class="Link Link_wrapper">© 2016 <span class="Link-Inner">Roman Komarov</span>. </a><a href="https://twitter.com/kizmarh" class="Link Link_wrapper"><span class="Link-Inner">Follow me on twitter</span>!</a>
          </p>
        </div>
      </div>
    </footer>
    <script>var supportsWoff2=function(A){if(!("FontFace"in A)||"function"!=typeof A.FontFace)return!1;var t=new FontFace("t",'url( "data:application/font-woff2;base64,d09GMgABAAAAAADcAAoAAAAAAggAAACWAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABk4ALAoUNAE2AiQDCAsGAAQgBSAHIBtvAcieB3aD8wURQ+TZazbRE9HvF5vde4KCYGhiCgq/NKPF0i6UIsZynbP+Xi9Ng+XLbNlmNz/xIBBqq61FIQRJhC/+QA/08PJQJ3sK5TZFMlWzC/iK5GUN40psgqvxwBjBOg6JUSJ7ewyKE2AAaXZrfUB4v+hze37ugJ9d+DeYqiDwVgCawviwVFGnuttkLqIMGivmDg" ) format( "woff2" )',{});return t.load()["catch"](function(){}),"loading"==t.status||"loaded"==t.status}(this),h=document.getElementsByTagName("head")[0],link=document.createElement("link");link.href="/s/extras"+(supportsWoff2?"2":"")+".css",link.type="text/css",link.rel="stylesheet",h.appendChild(link);
    </script>
    <script src="/j/prism.js"></script>
    <script src="//mc.yandex.ru/metrika/watch.js"></script>
    <script type="text/javascript">
      //<![CDATA[
      (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter632758 = new Ya.Metrika({id:632758, clickmap:true, trackLinks:true, trackHash:true, webvisor:true}); } catch(e) {} }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f); } else { f(); } })(document, window, "yandex_metrika_callbacks");
      //]]>
    </script>
    <noscript><img src="//mc.yandex.ru/watch/632758" style="position:absolute; left:-9990px;" alt=""></noscript>
  </body>
</html>