<!DOCTYPE html>
<html lang="en" class="Page Page_post Page_en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <title>SVG Stacks with Media Queries</title>
    <link rel="alternate" type="application/atom+xml" title="Atom feed" href="http://feeds.feedburner.com/kizuruen">
    <link rel="stylesheet" href="/s/style.css">
    <link rel="preload" href="/s/extras2.css" as="style" onload="this.rel='stylesheet'">
  </head>
  <body class="Page-Body">
    <header class="Page-Header">
      <div class="LiquidLayout">
        <div class="LiquidLayout-Content">
          <h1 class="Page-Title"><a href="/en/" class="Page-Title-Link">Roman Komarov</a>
          </h1>
          <ul class="Page-Languages">
            <li data-short="en" class="Page-Language is-current">in English
            </li>
            <li class="Page-Language"><a data-short="ru" title="Для этой статьи пока нет перевода, почему — можете узнать перейдя по этой ссылке" href="/blog/just-en/" class="Page-Language-Link">по-русски?</a>
            </li>
          </ul>
        </div>
      </div>
    </header>
    <article role="main" class="Page-Content">
      <div class="LiquidLayout">
        <div class="Main LiquidLayout-Content">
          <header><h1 class="Heading" id="svg-stacks-with-media-queries"><a class="Anchor" aria-hidden="true" href="#svg-stacks-with-media-queries"></a><span class="ss01 hang-xs">S</span>VG Stacks with Me­dia Queries</h1>
          </header>
<p>I love <abbr>SVG</abbr> and what I don&#39;t like is how browsers don&#39;t tend to im­prove in the sup­port for them. And while some time ago it could be called “a chicken and egg prob­lem”<span class="nobr"> —</span><span class="thinsp"> </span>there were no sup­port be­cause of lack of us­age and de­vel­oper in­ter­est, as well as de­vel­op­ers didn&#39;t look at <abbr>SVG</abbr> be­cause there were a lot of bugs and in­con­sis­tency every­where.</p>
<p>But in the last year or two I saw a lot of ar­ti­cles on <abbr>SVG</abbr> and a lot of peo­ple use it more and <span class="Sidenote-Wrapper"><a class="Sidenote-Context" href="#articles" id="articles">more</a><span class="Sidenote" role="note"><span class="Sidenote-Misc"> (</span>For ex­am­ple a few days ago my col­league from Yan­dex, Alexey Ten, wrote <a href="http://lynn.ru/examples/svg/en.html">an ar­ti­cle</a> on sim­ple but pow­er­ful tech­nique for grace­ful degra­da­tion with <abbr>SVG</abbr><span class="Sidenote-Misc">)</span></span><a class="Sidenote-Close" href="#x" aria-hidden="true" tabindex="-1"></a></span>. I&#39;d say it&#39;s what “Retina” did, but whatever.</p>
<p>Any­way, I&#39;d like to talk about one of those hard-needed fea­tures that won&#39;t ship there any­time soon: <abbr>SVG</abbr> Stacks. You can be fa­mil­iar with this idea from <a class="Link" href="http://simurai.com/post/20251013889/svg-stacks">this great ar­ti­cle of Simu­rai</a><span class="nobr"> —</span><span class="thinsp"> </span>the point is to have dif­fer­ent <abbr>SVG</abbr> im­ages in­side one file and to show only the one we need us­ing <code>:tar­get</code> in <abbr>CSS</abbr> em­bed­ded in <abbr>SVG</abbr> and urls like <code>url(stack.svg#foo)</code>.</p>
<p>But we can&#39;t use it be­cause of <a class="Link" href="https://code.google.com/p/chromium/issues/detail?id=128055#c6">ephemeral se­cu­rity rea­sons</a>. Well, whatever.</p>
<p>I&#39;d like to show you how we can achieve some­thing sim­i­lar today.</p>
<p>It is a hack, it is an ex­per­i­ment, it have its flaws and it was not tested in pro­duc­tion. But hey!</p>
<div class="Demo Figure" id="Demo_svg-stack-queries"><iframe class="Demo-Frame" style="height: 1.5em" width="100%" src="svg-stack-queries.html"></iframe></div>
<p>Well, the code wouldn&#39;t be that el­e­gant as with orig­i­nal <abbr>SVG</abbr> Stacks idea, but what I did is a Proof of Concept.</p>
<p>The <abbr>HTML</abbr> for those icons is this:</p>
<pre><code class="language-html">&lt;span class=&quot;icon-wrapper&quot;&gt;
    &lt;img class=&quot;icon icon_download&quot; src=&quot;test3.svg&quot; alt=&quot;&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;icon-wrapper&quot;&gt;
    &lt;img class=&quot;icon icon_next&quot; src=&quot;test3.svg&quot; alt=&quot;&quot;&gt;
&lt;/span&gt;
&lt;span class=&quot;icon-wrapper&quot;&gt;
    &lt;img class=&quot;icon icon_print&quot; src=&quot;test3.svg&quot; alt=&quot;&quot;&gt;
&lt;/span&gt;
</code></pre>
<p>The <abbr>SVG</abbr> it­self would look like this:</p>
<pre><code class="language-markup">&lt;svg xmlns=&quot;http://www.w3.org/2000/svg&quot;&gt;
    &lt;style&gt;

.icon { display: none }

@media (aspect-ratio: 1/2), (aspect-ratio: 2/1) { #download { display: inline; }}
@media (aspect-ratio: 1/3), (aspect-ratio: 3/1) { #next { display: inline; }}
@media (aspect-ratio: 1/5), (aspect-ratio: 5/1) { #print { display: inline; }}

@media (orientation: landscape) { .icon { fill: blue; } }


    &lt;/style&gt;

    &lt;path class=&quot;icon&quot; id=&quot;download&quot; d=&quot;M2,6h3V1h6v5h3L8,12m7,1v2H1V13&quot;&gt;&lt;/path&gt;
    &lt;path class=&quot;icon&quot; id=&quot;next&quot; d=&quot;M5 1v14l9-7&quot;&gt;&lt;/path&gt;
    &lt;path class=&quot;icon&quot; id=&quot;print&quot; d=&quot;M4,2h8v2h1V1H3v3h1M0,5v6h3v1l3,3h7v-4h3V5m-3,2v1H12v6H6V12H4V8H3V7m2,1h6v1H5m0,1h6v1H5&quot;&gt;&lt;/path&gt;
&lt;/svg&gt;
</code></pre>
<p>And the <span class="Sidenote-Wrapper"><a class="Sidenote-Context" href="#webkit-bug" id="webkit-bug"><em>ba­sic</em></a><span class="Sidenote" role="note"><span class="Sidenote-Misc"> (</span>There is a bug in We­bkit pre­vent­ing the icons to be shown on page load. You could fix it with some­thing that would cause a re­flow, like an an­i­ma­tion, you can see how I ap­plied it in the …<span class="Sidenote-Misc">)</span></span><a class="Sidenote-Close" href="#x" aria-hidden="true" tabindex="-1"></a></span> <abbr>CSS</abbr> would look this way:</p>
<pre><code class="language-css">.icon-wrapper {
    display: inline-block;
    vertical-align: top;
    overflow: hidden;

    width: 16px;
    height: 16px;
}

.icon {
    vertical-align: top;
}

.icon_download       { width: 120px; height: 240px; }
.icon_download:hover { width: 240px; height: 120px; }

.icon_next           { width: 120px; height: 360px; }
.icon_next:hover     { width: 360px; height: 120px; }

.icon_print          { width: 120px; height: 600px; }
.icon_print:hover    { width: 600px; height: 120px; }
</code></pre>
<p>I guess you al­ready got the idea? While we can&#39;t use <code>:tar­get</code>, you could al­ready know that we can use <span class="Sidenote-Wrapper"><a class="Sidenote-Context" href="#clowncar" id="clowncar">me­dia queries in <abbr>SVG</abbr></a><span class="Sidenote" role="note"><span class="Sidenote-Misc"> (</span>See, for ex­am­ple <a href="http://coding.smashingmagazine.com/2013/06/02/clown-car-technique-solving-for-adaptive-images-in-responsive-web-design/">Clown Car Tech­nique</a> by Es­telle<span class="Sidenote-Misc">)</span></span><a class="Sidenote-Close" href="#x" aria-hidden="true" tabindex="-1"></a></span>.</p>
<p>So, we hide all the icons in­side an <abbr>SVG</abbr> and then show­ing them when the spe­cific me­dia queries are trig­gered.</p>
<p>Some notes on some things in code you&#39;re al­ready won­der­ing on:</p>
<ol>
<li><p>We should use <code>&lt;img/&​gt;</code> (or any sim­i­lar method) in­stead of <abbr>SVG</abbr> in <abbr>CSS</abbr> back­grounds, &#39;cause there are a lot of <span class="Sidenote-Wrapper"><a class="Sidenote-Context" href="#svg-in-css" id="svg-in-css">is­sues</a><span class="Sidenote" role="note"><span class="Sidenote-Misc"> (</span>…<span class="Sidenote-Misc">)</span></span><a class="Sidenote-Close" href="#x" aria-hidden="true" tabindex="-1"></a></span> with back­grounds in dif­fer­ent browsers. And that&#39;s sad, &#39;cause we could use only one el­e­ment in <abbr>HTML</abbr> for those icons then, us­ing <code>back­ground-im­age</code> or <span class="nobr">pseudo-el</span>­e­ments.</p>
</li>
<li><p>I&#39;ve used a wrap­per to show only the ac­tual part of the <abbr>SVG</abbr>, hid­ing the ex­tra can­vas that is needed only for me­dia queries. How­ever, if you&#39;re ok with ab­solute po­si­tion­ing, you could use it along with <code>clip</code> to hide the extras:</p>
<pre><code class="language-css"> .icon_absolute {
     position: absolute;
     clip: rect(0, 16px, 16px, 0);
 }
</code></pre>
</li>
<li><p>An im­por­tant part: your <code>&lt;svg&gt;</code> tag should be with­out <code>width</code>, <code>height</code> or <code>view­Box</code> at­trib­utes. This would make icons to not re­size when the con­tainer re­sizes, so we could ac­tu­ally change the size of <code>&lt;img/&​gt;</code> con­tain­ing the <abbr>SVG</abbr> with­out re­siz­ing the icons.</p>
</li>
<li><p>While you could use MQ with <code>min-width</code> and <code>max-width</code>, I ended up with us­ing <code>as­pect-ra­tio</code>. Why? Be­cause if we&#39;d re­size the page, the size of icons would change, and the width/​height based MQ would broke (at least in we­bkits).</p>
</li>
<li><p>And I used a bit big num­bers like <code>120px</code> etc. to keep the as­pect ra­tios <span class="nobr">strict —</span><span class="thinsp"> </span>if we&#39;d use small ones like <code>16px</code> etc, then on page re­size they would be changed un­evenly, so the <code>as­pect-ra­tio</code> would be bro­ken. Hav­ing a big num­ber makes most of the zoom lev­els pre­serve proper as­pect ratio.</p>
</li>
<li><p>If you&#39;d want to use only icons, with­out the hover state, the code would be even sim­pler, but I shown this there &#39;cause it&#39;s just an­other nice use case for <abbr>SVG</abbr> Stacks, and also to show how you can do it us­ing MQ: you show an icon on both ori­en­ta­<span class="nobr">tions —</span><span class="thinsp"> </span><code>(as­pect-ra­tio: 1/​2), (as­pect-ra­tio: 2/​1)</code> and then you can use one of them to make a hover state, and you could use the same one for every icon us­ing <code>ori­en­ta­tion</code> query.</p>
</li>
</ol>
<p>So, that&#39;s it! While all this works, there are still a lot of is­sues in dif­fer­ent browsers, most of them are in we­bkits. For ex­am­ple, those icons won&#39;t re­size in a vec­tor way on iOS (what would be the best way to fix it? Make icons big­ger from the start and them zoom them down us­ing trans­forms?), they need the an­i­ma­tion both on the page load and on hover (there are <em>strange</em> bugs for this) and who knows what else could go wrong?</p>
<p>But I still love this small ex­per­i­ment, &#39;cause it makes the idea to work and I can&#39;t wait for the bright fu­ture when we could just use proper <abbr>SVG</abbr> Stacks with­out all those hacks.</p>

          <p class="Metadata Published">Wrote as a draft, not published yet.
          </p>
          <aside class="Feedback">
            <p>If you've spotted a typo or a mistake, or wish to add something on, you could either <a href="https://github.com/kizu/kizu.github.com/issues/new?title=Feedback%20for%20%E2%80%9CSVG%20Stacks%20with%20Media%20Queries%E2%80%9D" class="Link">write me about this</a> or <a href="https://github.com/kizu/kizu.github.com/blob/source/src/documents/posts/drafts/(fun)-svg-stack-queries/index.en.md" class="Link">edit this article on Github</a>.
            </p>
          </aside>
        </div>
      </div>
    </article>
    <footer class="Page-Footer">
      <div class="LiquidLayout">
        <div class="LiquidLayout-Content">
          <nav class="PrevNext">
          </nav>
          <p role="contentinfo" class="Page-Copy"><a href="/en/" class="Link Link_wrapper">© 2017 <span class="Link-Inner">Roman Komarov</span>. </a><a href="https://twitter.com/kizmarh" class="Link Link_wrapper"><span class="Link-Inner">Follow me on twitter</span>!</a>
          </p>
        </div>
      </div>
    </footer>
    <script>var supportsWoff2=function(A){if(!("FontFace"in A)||"function"!=typeof A.FontFace)return!1;var t=new FontFace("t",'url( "data:application/font-woff2;base64,d09GMgABAAAAAADcAAoAAAAAAggAAACWAAEAAAAAAAAAAAAAAAAAAAAAAAAAAAAABk4ALAoUNAE2AiQDCAsGAAQgBSAHIBtvAcieB3aD8wURQ+TZazbRE9HvF5vde4KCYGhiCgq/NKPF0i6UIsZynbP+Xi9Ng+XLbNlmNz/xIBBqq61FIQRJhC/+QA/08PJQJ3sK5TZFMlWzC/iK5GUN40psgqvxwBjBOg6JUSJ7ewyKE2AAaXZrfUB4v+hze37ugJ9d+DeYqiDwVgCawviwVFGnuttkLqIMGivmDg" ) format( "woff2" )',{});return t.load()["catch"](function(){}),"loading"==t.status||"loaded"==t.status}(this),h=document.getElementsByTagName("head")[0],link=document.createElement("link");link.href="/s/extras"+(supportsWoff2?"2":"")+".css",link.type="text/css",link.rel="stylesheet",h.appendChild(link);
    </script>
    <script src="/j/prism.js"></script>
    <script src="//mc.yandex.ru/metrika/watch.js"></script>
    <script type="text/javascript">
      //<![CDATA[
      (function (d, w, c) { (w[c] = w[c] || []).push(function() { try { w.yaCounter632758 = new Ya.Metrika({id:632758, clickmap:true, trackLinks:true, trackHash:true, webvisor:true}); } catch(e) {} }); var n = d.getElementsByTagName("script")[0], s = d.createElement("script"), f = function () { n.parentNode.insertBefore(s, n); }; s.type = "text/javascript"; s.async = true; s.src = (d.location.protocol == "https:" ? "https:" : "http:") + "//mc.yandex.ru/metrika/watch.js"; if (w.opera == "[object Opera]") { d.addEventListener("DOMContentLoaded", f); } else { f(); } })(document, window, "yandex_metrika_callbacks");
      //]]>
    </script>
    <noscript><img src="//mc.yandex.ru/watch/632758" style="position:absolute; left:-9990px;" alt=""></noscript>
  </body>
</html>