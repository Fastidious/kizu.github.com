---

categories: blog

layout: post

published: true

invisible: true

---

# Гибкая базовая линия

Раньше я очень любил инлайн-блоки. С их помощью можно очень гибко работать с потоком и, в принципе, делать многое, что иными способами сделать было бы очень сложно.

Но меня всегда смущало один аспект их поведения — вертикальное выравнивание относительно текста. Чаще всего набор инлайновых блоков хочется выравнить по базовой линии шрифта — `vertical-align: baseline`. Но, по специфицации, у инлайн-блоков есть две больших проблемы:

1. Выравнивание происходит по базовой линии **последней** строчки многострочного инлайнового блока.

2. Если у инлайн-блока есть `overflow` отличный от `visible`, такое выравнивание перестаёт работать, так как «базовой линией» такого блока становится нижняя граница блока.

В итоге, если простые блоки мы ещё как-то можем выравнивать по одной базовой линии, то как только ситуация усложняется, появляются составные блоки, которые могут быть или многострочными, или которым нужно задавать по какой-то причине `overflow: hidden`, мы теряем возможность правильно выравнивать блоки.

*пример хреновых инлайн-блоков*

## Спасительный flex

И тут на помощь приходят флексбоксы. Оказывается, они не наследуют вредное поведение инлайн-блоков и выравнивание по базовой линии в рамках флексбоксов будет работать *правильно*!

### Многострочные дети

Чтобы выровнить детей по честной базовой линии **первой строчки**, достаточно врапперу сказать

{:.language-css}
    display: flex;
    align-items: baseline;

*пример*

Во всех современных браузерах *проверить в ие* это заработает! Ура!

### overflow

А вот с `overflow`, отличным от `visible` всё чуть сложнее.

{:.language-css}
    display: flex;
    align-items: baseline;
    overflow: hidden;

*пример*

Если в вебкитах базовая линия останется верной, то для ФФ всё будет хорошо пока верхний паддинг для внутреннего элемента равен нулю. Но как только мы сделаем его положительным, всё поедет — ровно на размер этого паддинга.

*есть ли воркэраунд?*

## inline-flex

Ок, флексбокс может помочь нам расположить всё правильно внутри элемента с `display: flex`.

Но как будет позиционироваться инлайн-флексовый блок относительно других блоков в том же инлайновом контексте? Можно было ожидать фейла, но, оказывается, всё немного радужнее.

### Многострочный inline-flex

Со многострочностью, опять, всё хорошо: такой блок, в отличие от инлайн-блока, будет иметь базовую линию на первой строчке.

*пример*

### inline-flex с overflow

А вот с overflow всё печальнее: в вебкитах всё ок, но всё опять взрывается в Fx, причём на этот раз совсем: Fx в этом случае ведёт себя как с инлайн-блоками и ставит базовую линию на нижнюю границу маджина.

*пример*

## Итого

В заключение можно сказать, что для выравнивания по базовой линии флексбокс оказывается незаменим. Для надёжного выравнивания лучше использовать выравнивание через `align-items` + воркэраунд для верхнего паддинга внутри блоков с overflow, отличным от ноля.

Выравнивать инлайн-флексы относительно друг друга можно, но только с overflow: visible, пока не будет починен соответствующий баг в ФФ.

*найти/завести баги ФФ*